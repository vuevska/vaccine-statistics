Worldwide.Vaccine.Data <- read.csv("C:/Users/majav/Downloads/Worldwide Vaccine Data.csv", stringsAsFactors=TRUE)
View(Worldwide.Vaccine.Data)
doses = Worldwide.Vaccine.Data$Doses.administered.per.100.people
n = length(doses)
sort(doses)
range(doses)
breaks = seq(0, 150, by=10)
breaks
doses.cut = cut(doses, breaks, right=FALSE)
freq = table(doses.cut)
rel.freq = freq / n
cum.freq = cumsum(freq)
rel.cum.freq = cumsum(freq) / n
rel.cum.freq2 = cumsum(rel.freq)
procent.freq = rel.freq *100
procent.cum.freq = rel.cum.freq * 100
doses.table
Worldwide.Vaccine.Data <- read.csv("C:/Users/majav/Downloads/Worldwide Vaccine Data.csv", stringsAsFactors=TRUE)
View(Worldwide.Vaccine.Data)
Worldwide.Vaccine.Data[is.na(x = Worldwide.Vaccine.Data)] <- 0
doses = Worldwide.Vaccine.Data$Doses.administered.per.100.people
n = length(doses)
sort(doses)
range(doses)
breaks = seq(0, 150, by=10)
breaks
doses.cut = cut(doses, breaks, right = FALSE)
doses.freq = table(doses.cut)
doses.rel.freq = doses.freq / n
doses.rel.freq
old = options(digits = 1)
doses.rel.freq
options(old)
old = options(digits = 1)
cbind(doses.freq, doses.rel.freq)
doses.cum.freq = cumsum(doses.freq)
doses.cum.rel.freq = doses.cum.freq / n
doses.cum.rel.freq
old = options(digits = 2)
doses.cum.rel.freq
options(old)
old = options(digits=2)
cbind(doses.cum.freq, doses.cum.rel.freq)
options(old)
doses.cum.rel.freq2 = cumsum(doses.rel.freq)
doses.p.freq = doses.rel.freq * 100
doses.p.cum.freq = doses.cum.rel.freq * 100
mid = c() for (i in 1:lenght(breaks)-1){mid = c(mid, (breaks[i]+breaks[i+1])/2)}
mid = c()
for (i in 1:lenght(breaks)-1){mid = c(mid, (breaks[i]+breaks[i+1])/2)}
for (i in 1:length(breaks)-1){mid = c(mid, (breaks[i]+breaks[i+1])/2)}
doses.rel.freq = doses.freq / n
Worldwide.Vaccine.Data <- read.csv("C:/Users/majav/Downloads/Worldwide Vaccine Data.csv", stringsAsFactors=TRUE)
View(Worldwide.Vaccine.Data)
doses = Worldwide.Vaccine.Data$Doses.administered.per.100.people
n = length(doses)
range(doses)
sort(doses)
breaks = seq(0, 150, by=10)
doses.int = cut(doses, breaks, right=FALSE)
freq = table(doses.int)
colors = c("red", "blue", "pink", "green", "purple", "cyan", "brown")
hist(doses, right = FALSE, col=colors, main="Дози администрирани на секои 100 луѓе", xlab = "граници на интервали", ylab = "честоти")
rel.freq = freq / n
rel.freq
old = options(digits=2)
rel.freq
old = options(digits = 1)
rel.freq
old = options(digits = 1)
rel.freq
options(old)
cbind(freq, rel.freq)
cum.freq = cumsum(freq)
cbind(freq, rel.freq, cum.freq)
rel.cum.freq = cumsum(freq) / n
rel.cum.freq2 = cumsum(rel.cum.freq)
p.freq = rel.freq * 100
p.cum.freq = rel.cum.freq * 100
cbind(freq, rel.freq, cum.freq, p.freq, p.cum.freq)
doses.table = cbind(freq, rel.freq, cum.freq, p.freq, p.cum.freq)
mid = c()
for (i in 1:length(breaks)-1){mid = c(mid, (breaks[i]+breaks[i+1])/2)}
cum.freq0 = c(0, cumsum(freq))
p.cum.freq0 = c(0, p.cum.freq)
plot(breaks, p.cum.freq0, main="Дози вакцини администрирани на секои 100 луѓе", xlab = "интервали", ylab = "кумулативни честоти во %")
lines(breaks, p.cum.freq0)
cum.rel.freq = cum.freq / n
p.cum.rel.freq = cum.rel.freq * 100
cum.rel.freq = cum.freq / n
old = options(digits = 2)
cum.rel.freq
old = options(digits = 2)
p.cum.rel.freq = cum.rel.freq * 100
p.rel.freq = rel.freq * 100
p.rel.cum.freq = rel.cum.freq * 100
cbind(mid, freq, rel.freq, p.rel.freq, cum.freq, rel.cum.freq, p.rel.cum.freq)
doses.table = cbind(mid, freq, rel.freq, p.rel.freq, cum.freq, rel.cum.freq, p.rel.cum.freq)
plot(rel.freq, main="Дози вакцини администрирани на секои 100 луѓе", xlab = "средни точки", ylab="Релативни честоти")
lines(mid, freq)
lines(mid, rel.freq)
stem(doses)
myStem <- function(x, leftDigits, rounding = 1) {
+     data = data.table("x" = x)
+     data[, left := floor(x/10^leftDigits)]
+     data[, right := (round(x - left*10^leftDigits, rounding))*10^rounding]
+     data = data[, paste(sort(right), collapse = " "), by = left]
+     data[, out := paste(left, " | ", V1), by = left]
+     cat(data$out, sep = "\n")
+ }
myStem <- function(x, leftDigits, rounding = 1) {
+     data = data.table("x" = x)
+     data[, left := floor(x/10^leftDigits)]
+     data[, right := (round(x - left*10^leftDigits, rounding))*10^rounding]
+     data = data[, paste(sort(right), collapse = " "), by = left]
+     data[, out := paste(left, " | ", V1), by = left]
+     cat(data$out, sep = "\n")
}
doses[is.na(x = doses)] <- 0 #set NA(not available) values to 0
onedose = Worldwide.Vaccine.Data$X..of.population.vaccinated
twodose = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
plot(onedose, twodose, main="Број на луѓе вакцинирани со една доза наспроти со две во %", xlab = "една доза", ylab = "две дози")
mean(doses)
median(doses)
my_mode <- function(x) {
+     unique_x <- unique(x)
+     tabulate_x <- tabulate(match(x, unique_x))
+     unique_x[tabulate_x == max(tabulate_x)]
+ }
my_mode <- function(x) {
unique_x <- unique(x)
tabulate_x <- tabulate(match(x, unique_x))
unique_x[tabulate_x == max(tabulate_x)]
}
my_mode(doses)
var(doses)
sd(doses)
cor(onedose, twodose)
Worldwide.Vaccine.Data[is.na(x = Worldwide.Vaccine.Data)] <- 0
cor(onedose, twodose)
onedose = Worldwide.Vaccine.Data$X..of.population.vaccinated
twodose = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
cor(onedose, twodose)
quantile(doses)
IQR(doses)
library(MASS)
fully = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
mean(fully, na.rm = TRUE)
newn = length(fully)
sd(fully)
sigma = 13
strerr = sigma / sqrt(newn)
strerr
E = qnorm(.975)*strerr
E
xbar = mean(fully)
xbar + c(-E, E)
#поставување хипотези
xbar = 9.7
xbar = mean(fully)
mu0 = 10.4
z = (xbar - mu0)/(sigma/sqrt(newn))
z
alpha = .05
z.half.alpha = qnorm(1-alpha/2)
c(-z.half.alpha, z.half.alpha)
#z pripagja vo intervalot na doverba zatoa ja otfrlame hipotezata H0
pnorm(10, mean=9.7, sd=13, lower.tail = FALSE)
distribution.test = pnorm(10, mean=9.7, sd=13, lower.tail = FALSE)
#regresiona analiza
doses.lm = lm(onedose ~ twodose, data=Worldwide.Vaccine.Data)
coeffs = coefficients(doses.lm)
coeffs
summary(doses.lm)$r.squared
koef.corelation = summary(doses.lm)$r.squared
koef = summary(doses.lm)$r.squared
koef
summary(doses.lm)
twodose = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
doses.lm = lm(onedose ~ twodose)
newdata = data.frame(m = 20)
doses.res = resid(doses.lm)
plot(Worldwide.Vaccine.Data$X..of.population.vaccinated, doses.res)
plot(Worldwide.Vaccine.Data$X..of.population.vaccinated, doses.res, xlab = "% на луѓе вакцинирани со две дози", ylab = "% на луѓе вакцинирани со една доза")
#test za nezavisnost
summary(table(Worldwide.Vaccine.Data$X..of.population.vaccinated, Worldwide.Vaccine.Data$X..of.population.fully.vaccinated))
X = Worldwide.Vaccine.Data$X..of.population.vaccinated
Y = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
chisq.test(X, Y)
summary(Worldwide.Vaccine.Data)
hist(Worldwide.Vaccine.Data$X..of.population.fully.vaccinated)
hist(Worldwide.Vaccine.Data$X..of.population.fully.vaccinated)
plot(X ~ Y, data = Worldwide.Vaccine.Data)
plot(X ~ Y, data=Worldwide.Vaccine.Data, xlab="две дози во %", ylab="една доза во %")
#ima linearna povrzanost megju obelezjata
cor(X, Y)
corelation = cor(X, Y)
corelation
hist(X)
hist(Y)
onedose.twodose.lm <- lm(X ~ Y, data=Worldwide.Vaccine.Data)
summary(onedose.twodose.lm)
plot(onedose.twodose.lm)
doses.res = resid(doses.lm)
plot(X, doses.res, xlab = "една доза", ylab = "две дози")
View(doses.table)
View(doses.table)
column = Worldwide.Vaccine.Data$X..of.population.fully.vaccinated
column
sort(column)
sample = S.SY(182, 10)
sample <- S.SY(182, 10)
sample = sample(Worldwide.Vaccine.Data$X..of.population.fully.vaccinated, 124, replace = FALSE, prob = NULL)
sample
xcrta = mean(sample)
xcrta
mu0 = 9.7
z = (xcrta - mu0)/(sigma/sqrt(newn))
z
shapiro.test(Worldwide.Vaccine.Data$X..of.population.fully.vaccinated)
shapiro.test(sample)
